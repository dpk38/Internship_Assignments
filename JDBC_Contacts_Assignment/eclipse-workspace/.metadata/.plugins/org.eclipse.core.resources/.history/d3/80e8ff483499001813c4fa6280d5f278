package com.ztech.jdbc;

import java.sql.*;
import java.util.Scanner;

public class ContactManagement {
	
	public static void createContact() {
		Scanner sc = new Scanner(System.in);
		Employee emp = new Employee();
		
		System.out.print("Please enter your first name: ");
		String firstName = sc.next();
		System.out.print("Please enter your last name: ");
		String lastName = sc.nextLine();
		System.out.print("Please enter your home number: ");
		long homeNumber = sc.nextLong();
		System.out.print("Please enter your office number: ");
		long officeNumber = sc.nextLong();
		System.out.print("Please enter your personal mobile number: ");
		long mobileNumber = sc.nextLong();
		System.out.print("Please enter your email id: ");
		sc.nextLine();
		String email = sc.nextLine();
		System.out.println("-----The entered details are: " + firstName + " " + lastName + " " + homeNumber + " " + officeNumber+ " " + mobileNumber + " " + email);
		
		emp.setNumber(homeNumber, officeNumber, mobileNumber);
		emp.setEmail(email);
		emp.setName(firstName, lastName);
		
		try {
			Class.forName("com.mysql.cj.jdbc.Driver");
			Connection con = DriverManager.getConnection("jdbc:mysql://localhost:3306/practice_schema", "root", "Ztech@123");
			Statement stmt = con.createStatement();
			stmt.execute("insert into contacts values ('" + emp.getFirstName()+ "','" + emp.getLastName() + "'," + emp.getMobileNumber() + "," + emp.getOfficeNumber() + "," + emp.getHomeNumber() + ",'" + emp.getEmail() + "')");
			con.close();
		} catch (Exception e) {
			System.out.println("Exception caught: " + e);
		}
	}
	
	public static void displayContact() {
		Scanner sc = new Scanner(System.in);
		System.out.println("1. Display mentioned contact\n2. Display all contacts\n3. Display all contacts (Desc)\nYour choice: ");
		int option = sc.nextInt();
		try {
			Class.forName("com.mysql.cj.jdbc.Driver");
			Connection con = DriverManager.getConnection("jdbc:mysql://localhost:3306/practice_schema", "root", "Ztech@123");
			Statement stmt = con.createStatement();
			ResultSet rs;
			switch(option) {
			case 1:
				System.out.println("Enter the first name of the contact to search: ");
				String search = sc.nextLine();
				rs = stmt.executeQuery("select * from contacts where firstName='" + search + "' order by firstName");
				while (rs.next()) {
					System.out.println(rs.getString(1) + " " + rs.getString(2) + " " + rs.getLong(3) + " " + rs.getLong(4) + " " + + rs.getLong(5) + " " + rs.getString(6));
				}
				break;
			case 2:
				rs = stmt.executeQuery("select * from contacts order by firstName");
				while(rs.next()) {
					System.out.println(rs.getString(1) + " " + rs.getString(2) + " " + rs.getLong(3) + " " + rs.getLong(4) + " " + + rs.getLong(5) + " " + rs.getString(6));					
				}
				break;
			case 3:
				rs = stmt.executeQuery("select * from contacts order by firstName desc");
				while(rs.next()) {
					System.out.println(rs.getString(1) + " " + rs.getString(2) + " " + rs.getLong(3) + " " + rs.getLong(4) + " " + + rs.getLong(5) + " " + rs.getString(6));					
				}
				break;
			default:
				System.out.println("Invalid option entered!");
			}
			con.close();
		} catch (Exception e) {
			System.out.println("Exception caught: " + e);
		}
		
	}
	
	public static void deleteContact() {
		Scanner sc = new Scanner(System.in);
		System.out.println("Enter the first name of the contact to delete: ");
		String name = sc.nextLine();
		try {
			Class.forName("com.mysql.cj.jdbc.Driver");
			Connection con = DriverManager.getConnection("jdbc:mysql://localhost:3306/practice_schema", "root", "Ztech@123");
			Statement stmt = con.createStatement();
			stmt.execute("delete from contacts where firstName='" + name + "'");
			con.close();
		} catch (Exception e) {
			System.out.println("Exception caught: " + e);
		}
				
	}
	
	public static void updateContact() {
		Scanner sc = new Scanner(System.in);
		System.out.println("Enter the first name of the contact to update: ");
		String search = sc.nextLine();
		System.out.print("1.First Name\n2.Last Name\n3.Mobile Number\n4.Office Number\n5.Home Number\n6.Email Id\nWhich field do you wish to update? ");
		int option = sc.nextInt();
		try {
			Class.forName("com.mysql.cj.jdbc.Driver");
			Connection con = DriverManager.getConnection("jdbc:mysql://localhost:3306/practice_schema", "root", "Ztech@123");
			Statement stmt = con.createStatement();
			switch(option) {
			case 1:
				System.out.println("Enter the first name: ");
				stmt.execute("update contacts set firstName='" + sc.nextLine() + "' where firstName='" + search + "'");
				break;
			case 2:
				System.out.println("Enter the last name: ");
				stmt.execute("update contacts set lastName='" + sc.nextLine() + "' where firstName='" + search + "'");
				break;
			case 3:
				System.out.println("Enter the mobile number: ");
				stmt.execute("update contacts set mobileNumber='" + sc.nextLong() + "' where firstName='" + search + "'");
				break;
			case 4:
				System.out.println("Enter the office number: ");
				stmt.execute("update contacts set officeNumber='" + sc.nextLong() + "' where firstName='" + search + "'");
				break;
			case 5:
				System.out.println("Enter the home number: ");
				stmt.execute("update contacts set homeNumber='" + sc.nextLong() + "' where firstName='" + search + "'");
				break;
			case 6:
				System.out.println("Enter the email id: ");
				stmt.execute("update contacts set email='" + sc.nextLine() + "' where firstName='" + search + "'");
				break;
			default:
				System.out.println("Invalid option entered!");
			}
			con.close();
		} catch (Exception e) {
			System.out.println("Exception caught: " + e);
		}
				
	}
	
	public static void main(String[] args) {
		Scanner sc = new Scanner(System.in);
		char ch;
		do {
			System.out.print("Menu:\n1. Create contact\n2. View Contact\n3. Edit Contact\n4.Delete Contact\nEnter your choice: ");
			int choice = sc.nextInt();
			switch(choice) {
			case 1:
				createContact();
				break;
			case 2:
				displayContact();
				break;
			case 3:
				updateContact();
				break;
			case 4:
				deleteContact();
				break;
			default:
				System.out.println("Invalid option entered!");
			}
			System.out.print("Do you wish to continue (y/n)? ");
			ch = sc.next().charAt(0);
		} while (ch == 'y' || ch == 'Y');
		
	}
}
